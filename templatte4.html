<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceFlow - Gestion Financi√®re</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-down { animation: slideDown 0.5s ease; }
        .animate-fade-in { animation: fadeIn 0.5s ease; }
        .animate-slide-up { animation: slideUp 0.3s ease; }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 min-h-screen p-5">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 mb-8 flex justify-between items-center animate-slide-down">
            <div class="flex items-center gap-3">
                <span class="text-5xl">üí∞</span>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-amber-500 bg-clip-text text-transparent">
                    FinanceFlow
                </h1>
            </div>
            <div class="text-gray-600 text-sm flex items-center gap-2">
                <span class="text-xl">üìÖ</span>
                <span id="currentDate"></span>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Total Revenus -->
            <div class="bg-white rounded-3xl shadow-xl p-8 relative overflow-hidden transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl animate-fade-in">
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-500 to-emerald-400"></div>
                <div class="text-sm text-gray-600 font-semibold uppercase tracking-wider mb-3">Total Revenus</div>
                <div id="totalIncome" class="text-5xl font-bold text-gray-800 mb-2">0 DH</div>
                <div class="flex items-center gap-2 text-sm text-green-600 font-medium">
                    <span>‚Üó</span>
                    <span>+0% ce mois</span>
                </div>
            </div>

            <!-- Total D√©penses -->
            <div class="bg-white rounded-3xl shadow-xl p-8 relative overflow-hidden transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl animate-fade-in" style="animation-delay: 0.1s;">
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-red-500 to-rose-400"></div>
                <div class="text-sm text-gray-600 font-semibold uppercase tracking-wider mb-3">Total D√©penses</div>
                <div id="totalExpense" class="text-5xl font-bold text-gray-800 mb-2">0 DH</div>
                <div class="flex items-center gap-2 text-sm text-red-600 font-medium">
                    <span>‚Üò</span>
                    <span>+0% ce mois</span>
                </div>
            </div>

            <!-- Solde Actuel -->
            <div class="bg-white rounded-3xl shadow-xl p-8 relative overflow-hidden transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl animate-fade-in" style="animation-delay: 0.2s;">
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-600 to-amber-500"></div>
                <div class="text-sm text-gray-600 font-semibold uppercase tracking-wider mb-3">Solde Actuel</div>
                <div id="balance" class="text-5xl font-bold text-gray-800 mb-2">0 DH</div>
                <div id="balanceStatus" class="flex items-center gap-2 text-sm text-amber-600 font-medium">
                    <span>‚óè</span>
                    <span>√âquilibr√©</span>
                </div>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="bg-white rounded-3xl shadow-xl p-8 mb-8 animate-fade-in" style="animation-delay: 0.3s;">
            <div class="flex items-center gap-3 mb-6 pb-4 border-b-2 border-gray-100">
                <span class="text-2xl">üìä</span>
                <h2 class="text-2xl font-bold text-gray-800">Vue d'ensemble mensuelle</h2>
            </div>
            <div class="relative h-80">
                <canvas id="monthlyChart"></canvas>
            </div>
        </div>

        <!-- Tables Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Revenus -->
            <div class="bg-white rounded-3xl shadow-xl p-8 animate-fade-in" style="animation-delay: 0.4s;">
                <div class="flex justify-between items-center mb-6 pb-4 border-b-2 border-gray-100">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üíµ</span>
                        <h2 class="text-2xl font-bold text-gray-800">Revenus</h2>
                    </div>
                    <button onclick="openModal('incomeModal')" class="bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-5 py-3 rounded-xl font-semibold text-sm uppercase tracking-wide shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1">
                        + Ajouter
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gradient-to-r from-indigo-600 to-indigo-700 text-white">
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider rounded-tl-xl">Description</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider">Montant</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider">Date</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider rounded-tr-xl">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="incomesBody" class="divide-y divide-gray-200">
                            <tr>
                                <td colspan="4" class="px-4 py-16 text-center">
                                    <div class="text-6xl mb-4 opacity-50">üí∞</div>
                                    <p class="text-gray-400">Aucun revenu enregistr√©</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- D√©penses -->
            <div class="bg-white rounded-3xl shadow-xl p-8 animate-fade-in" style="animation-delay: 0.5s;">
                <div class="flex justify-between items-center mb-6 pb-4 border-b-2 border-gray-100">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üí≥</span>
                        <h2 class="text-2xl font-bold text-gray-800">D√©penses</h2>
                    </div>
                    <button onclick="openModal('expenseModal')" class="bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white px-5 py-3 rounded-xl font-semibold text-sm uppercase tracking-wide shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1">
                        + Ajouter
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gradient-to-r from-indigo-600 to-indigo-700 text-white">
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider rounded-tl-xl">Description</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider">Montant</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider">Date</th>
                                <th class="px-4 py-4 text-left text-xs font-semibold uppercase tracking-wider rounded-tr-xl">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="expensesBody" class="divide-y divide-gray-200">
                            <tr>
                                <td colspan="4" class="px-4 py-16 text-center">
                                    <div class="text-6xl mb-4 opacity-50">üõí</div>
                                    <p class="text-gray-400">Aucune d√©pense enregistr√©e</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Revenu -->
    <div id="incomeModal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm transition-opacity" onclick="closeModal('incomeModal')"></div>
            <div class="relative bg-white rounded-3xl shadow-2xl max-w-lg w-full p-10 animate-slide-up">
                <div class="flex justify-between items-center mb-8">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">üíµ</span>
                        <h3 class="text-2xl font-bold text-gray-800">Ajouter un Revenu</h3>
                    </div>
                    <button onclick="closeModal('incomeModal')" class="text-gray-400 hover:text-red-600 text-3xl transition-colors">
                        &times;
                    </button>
                </div>
                <form onsubmit="addIncome(event)" class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                        <input type="text" id="incomeDesc" placeholder="Ex: Salaire" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Montant (DH)</label>
                        <input type="number" id="incomeAmount" step="0.01" placeholder="0.00" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Date</label>
                        <input type="date" id="incomeDate" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-4 rounded-xl font-bold text-sm uppercase tracking-wide shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1">
                        Enregistrer
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal D√©pense -->
    <div id="expenseModal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm transition-opacity" onclick="closeModal('expenseModal')"></div>
            <div class="relative bg-white rounded-3xl shadow-2xl max-w-lg w-full p-10 animate-slide-up">
                <div class="flex justify-between items-center mb-8">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">üí≥</span>
                        <h3 class="text-2xl font-bold text-gray-800">Ajouter une D√©pense</h3>
                    </div>
                    <button onclick="closeModal('expenseModal')" class="text-gray-400 hover:text-red-600 text-3xl transition-colors">
                        &times;
                    </button>
                </div>
                <form onsubmit="addExpense(event)" class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                        <input type="text" id="expenseDesc" placeholder="Ex: Courses" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Montant (DH)</label>
                        <input type="number" id="expenseAmount" step="0.01" placeholder="0.00" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Date</label>
                        <input type="date" id="expenseDate" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 transition-all outline-none">
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white py-4 rounded-xl font-bold text-sm uppercase tracking-wide shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1">
                        Enregistrer
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        let incomes = [];
        let expenses = [];
        let chart = null;

        // Initialisation
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric' });
        document.getElementById('incomeDate').valueAsDate = new Date();
        document.getElementById('expenseDate').valueAsDate = new Date();

        // Gestion des modals
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Ajouter un revenu
        function addIncome(e) {
            e.preventDefault();
            const income = {
                id: Date.now(),
                description: document.getElementById('incomeDesc').value,
                amount: parseFloat(document.getElementById('incomeAmount').value),
                date: document.getElementById('incomeDate').value
            };
            incomes.push(income);
            updateIncomesTable();
            updateStats();
            updateChart();
            closeModal('incomeModal');
            e.target.reset();
            document.getElementById('incomeDate').valueAsDate = new Date();
        }

        // Ajouter une d√©pense
        function addExpense(e) {
            e.preventDefault();
            const expense = {
                id: Date.now(),
                description: document.getElementById('expenseDesc').value,
                amount: parseFloat(document.getElementById('expenseAmount').value),
                date: document.getElementById('expenseDate').value
            };
            expenses.push(expense);
            updateExpensesTable();
            updateStats();
            updateChart();
            closeModal('expenseModal');
            e.target.reset();
            document.getElementById('expenseDate').valueAsDate = new Date();
        }

        // Supprimer un revenu
        function deleteIncome(id) {
            if (confirm('Voulez-vous vraiment supprimer ce revenu ?')) {
                incomes = incomes.filter(i => i.id !== id);
                updateIncomesTable();
                updateStats();
                updateChart();
            }
        }

        // Supprimer une d√©pense
        function deleteExpense(id) {
            if (confirm('Voulez-vous vraiment supprimer cette d√©pense ?')) {
                expenses = expenses.filter(e => e.id !== id);
                updateExpensesTable();
                updateStats();
                updateChart();
            }
        }

        // Mettre √† jour le tableau des revenus
        function updateIncomesTable() {
            const tbody = document.getElementById('incomesBody');
            if (incomes.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" class="px-4 py-16 text-center">
                            <div class="text-6xl mb-4 opacity-50">üí∞</div>
                            <p class="text-gray-400">Aucun revenu enregistr√©</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = incomes.map(income => `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-4 py-4 text-sm text-gray-800">${income.description}</td>
                    <td class="px-4 py-4">
                        <span class="inline-block px-3 py-1 rounded-lg text-xs font-semibold bg-green-100 text-green-800">
                            ${income.amount.toFixed(2)} DH
                        </span>
                    </td>
                    <td class="px-4 py-4 text-sm text-gray-600">${new Date(income.date).toLocaleDateString('fr-FR')}</td>
                    <td class="px-4 py-4">
                        <button onclick="deleteIncome(${income.id})" class="bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white px-4 py-2 rounded-lg text-xs font-semibold uppercase tracking-wide transition-all duration-300 hover:-translate-y-0.5 shadow-md hover:shadow-lg">
                            Supprimer
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Mettre √† jour le tableau des d√©penses
        function updateExpensesTable() {
            const tbody = document.getElementById('expensesBody');
            if (expenses.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" class="px-4 py-16 text-center">
                            <div class="text-6xl mb-4 opacity-50">üõí</div>
                            <p class="text-gray-400">Aucune d√©pense enregistr√©e</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = expenses.map(expense => `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-4 py-4 text-sm text-gray-800">${expense.description}</td>
                    <td class="px-4 py-4">
                        <span class="inline-block px-3 py-1 rounded-lg text-xs font-semibold bg-red-100 text-red-800">
                            ${expense.amount.toFixed(2)} DH
                        </span>
                    </td>
                    <td class="px-4 py-4 text-sm text-gray-600">${new Date(expense.date).toLocaleDateString('fr-FR')}</td>
                    <td class="px-4 py-4">
                        <button onclick="deleteExpense(${expense.id})" class="bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white px-4 py-2 rounded-lg text-xs font-semibold uppercase tracking-wide transition-all duration-300 hover:-translate-y-0.5 shadow-md hover:shadow-lg">
                            Supprimer
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Mettre √† jour les statistiques
        function updateStats() {
            const totalIncome = incomes.reduce((sum, i) => sum + i.amount, 0);
            const totalExpense = expenses.reduce((sum, e) => sum + e.amount, 0);
            const balance = totalIncome - totalExpense;

            document.getElementById('totalIncome').textContent = totalIncome.toFixed(2) + ' DH';
            document.getElementById('totalExpense').textContent = totalExpense.toFixed(2) + ' DH';
            document.getElementById('balance').textContent = balance.toFixed(2) + ' DH';

            const balanceStatus = document.getElementById('balanceStatus');
            if (balance > 0) {
                balanceStatus.innerHTML = '<span>‚óè</span><span>Positif</span>';
                balanceStatus.className = 'flex items-center gap-2 text-sm text-green-600 font-medium';
            } else if (balance < 0) {
                balanceStatus.innerHTML = '<span>‚óè</span><span>N√©gatif</span>';
                balanceStatus.className = 'flex items-center gap-2 text-sm text-red-600 font-medium';
            } else {
                balanceStatus.innerHTML = '<span>‚óè</span><span>√âquilibr√©</span>';
                balanceStatus.className = 'flex items-center gap-2 text-sm text-amber-600 font-medium';
            }
        }

        // Mettre √† jour le graphique
        function updateChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            const months = ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Ao√ª', 'Sep', 'Oct', 'Nov', 'D√©c'];
            const incomeData = new Array(12).fill(0);
            const expenseData = new Array(12).fill(0);

            incomes.forEach(income => {
                const month = new Date(income.date).getMonth();
                incomeData[month] += income.amount;
            });

            expenses.forEach(expense => {
                const month = new Date(expense.date).getMonth();
                expenseData[month] += expense.amount;
            });

            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Revenus',
                        data: incomeData,
                        backgroundColor: 'rgba(16, 185, 129, 0.8)',
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 2,
                        borderRadius: 8
                    }, {
                        label: 'D√©penses',
                        data: expenseData,
                        backgroundColor: 'rgba(239, 68, 68, 0.8)',
                        borderColor: 'rgba(239, 68, 68, 1)',
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                padding: 15
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Initialiser le graphique
        updateChart();
    </script>
</body>
</html>


<?php 
session_start();

$pdo = new PDO("mysql:host=localhost;dbname=smart_wallet","root","");

// R√©cup√©ration s√©curis√©e des donn√©es POST
$incomeCategory = $_POST["incomeCategory"] ?? null;
$incomeAmount = $_POST["incomeAmount"] ?? null;
$incomeDesc = $_POST["incomeDesc"] ?? null; 
$incomeDate = $_POST["incomeDate"] ?? null; 

$expenseCategory = $_POST["expenseCategory"] ?? null;
$expenseAmount = $_POST["expenseAmount"] ?? null;
$expenseDesc = $_POST["expenseDesc"] ?? null;
$expenseDate = $_POST["expenseDate"] ?? null;

$incomeUpdateid = $_POST['incomeUpdateid'] ?? null;
$incomeUpdateCategory = $_POST['incomeUpdateCategory'] ?? null;
$incomeUpdateAmount = $_POST['incomeUpdateAmount'] ?? null;
$incomeUpdateDesc = $_POST['incomeUpdateDesc'] ?? null;
$incomeUpdateDate = $_POST['incomeUpdateDate'] ?? null;

$expenseUpdateid = $_POST['expenseUpdateid'] ?? null;
$expenseUpdateCategory = $_POST['expenseUpdateCategory'] ?? null;
$expenseUpdateAmount = $_POST['expenseUpdateAmount'] ?? null;
$expenseUpdateDesc = $_POST['expenseUpdateDesc'] ?? null;
$expenseUpdateDate = $_POST['expenseUpdateDate'] ?? null;

$incomeDelete = $_POST['incomeDelete'] ?? null;
$expenseDelete = $_POST['expenseDelete'] ?? null;

// INSERT INCOME
if (!empty($incomeCategory) && !empty($incomeAmount) && !empty($incomeDesc)) {
    if (!empty($incomeDate)) {
        $stmt = $pdo->prepare("INSERT INTO incomes (categorie, montants, description, date) VALUES (?, ?, ?, ?)");
        $stmt->execute([$incomeCategory, $incomeAmount, $incomeDesc, $incomeDate]);
    } else {
        $stmt = $pdo->prepare("INSERT INTO incomes (categorie, montants, description) VALUES (?, ?, ?)");
        $stmt->execute([$incomeCategory, $incomeAmount, $incomeDesc]);
    }
}

// INSERT EXPENSE
if (!empty($expenseCategory) && !empty($expenseAmount) && !empty($expenseDesc)) {
    if (!empty($expenseDate)) {
        $stmt = $pdo->prepare("INSERT INTO expenses (categorie, montants, description, date) VALUES (?, ?, ?, ?)");
        $stmt->execute([$expenseCategory, $expenseAmount, $expenseDesc, $expenseDate]);
    } else {
        $stmt = $pdo->prepare("INSERT INTO expenses (categorie, montants, description) VALUES (?, ?, ?)");
        $stmt->execute([$expenseCategory, $expenseAmount, $expenseDesc]);
    }
}

// UPDATE INCOME
if (!empty($incomeUpdateid) && !empty($incomeUpdateCategory) && !empty($incomeUpdateAmount) && !empty($incomeUpdateDesc)) {
    if (!empty($incomeUpdateDate)) {
        $stmt = $pdo->prepare("UPDATE incomes SET categorie = ?, montants = ?, description = ?, date = ? WHERE id = ?");
        $stmt->execute([$incomeUpdateCategory, $incomeUpdateAmount, $incomeUpdateDesc, $incomeUpdateDate, $incomeUpdateid]);
    } else {
        $stmt = $pdo->prepare("UPDATE incomes SET categorie = ?, montants = ?, description = ? WHERE id = ?");
        $stmt->execute([$incomeUpdateCategory, $incomeUpdateAmount, $incomeUpdateDesc, $incomeUpdateid]);
    }
}

// UPDATE EXPENSE
if (!empty($expenseUpdateid) && !empty($expenseUpdateCategory) && !empty($expenseUpdateAmount) && !empty($expenseUpdateDesc)) {
    if (!empty($expenseUpdateDate)) {
        $stmt = $pdo->prepare("UPDATE expenses SET categorie = ?, montants = ?, description = ?, date = ? WHERE id = ?");
        $stmt->execute([$expenseUpdateCategory, $expenseUpdateAmount, $expenseUpdateDesc, $expenseUpdateDate, $expenseUpdateid]);
    } else {
        $stmt = $pdo->prepare("UPDATE expenses SET categorie = ?, montants = ?, description = ? WHERE id = ?");
        $stmt->execute([$expenseUpdateCategory, $expenseUpdateAmount, $expenseUpdateDesc, $expenseUpdateid]);
    }
}

// DELETE INCOME
if (!empty($incomeDelete)) {
    $stmt = $pdo->prepare("DELETE FROM incomes WHERE id = ?");
    $stmt->execute([$incomeDelete]);
}

// DELETE EXPENSE
if (!empty($expenseDelete)) {
    $stmt = $pdo->prepare("DELETE FROM expenses WHERE id = ?");
    $stmt->execute([$expenseDelete]);
}

header("Location: index.php");
exit;
?>
